Version 4
SHEET 1 1764 708
WIRE 144 -240 80 -240
WIRE 288 -240 224 -240
WIRE 80 -176 80 -240
WIRE 160 -176 80 -176
WIRE 288 -176 288 -240
WIRE 288 -176 208 -176
WIRE 160 -160 160 -176
WIRE 208 -160 208 -176
WIRE 144 -112 -752 -112
WIRE 240 -112 224 -112
WIRE 288 -112 240 -112
WIRE 464 -112 288 -112
WIRE 528 -112 464 -112
WIRE 752 -112 528 -112
WIRE 928 -112 752 -112
WIRE 1168 -112 1008 -112
WIRE 1360 -112 1232 -112
WIRE 1360 -96 1360 -112
WIRE 752 -80 752 -112
WIRE -160 -32 -608 -32
WIRE -96 -32 -160 -32
WIRE -16 -32 -96 -32
WIRE 80 -32 -16 -32
WIRE 528 16 528 -112
WIRE -752 32 -752 -112
WIRE -608 32 -608 -32
WIRE 752 32 752 -16
WIRE 1360 32 1360 -16
WIRE -96 64 -96 -32
WIRE -16 80 -16 -32
WIRE 288 80 288 -112
WIRE 80 128 80 -32
WIRE 464 128 464 -112
WIRE -752 144 -752 112
WIRE -608 144 -608 112
WIRE -512 176 -608 176
WIRE -96 176 -96 144
WIRE -96 176 -512 176
WIRE -16 176 -16 144
WIRE -16 176 -96 176
WIRE 64 176 -16 176
WIRE 384 176 160 176
WIRE 528 176 528 96
WIRE 528 176 480 176
WIRE 736 176 528 176
WIRE 1264 176 816 176
WIRE 1360 176 1264 176
WIRE -608 192 -608 176
WIRE 1360 192 1360 176
WIRE -160 224 -160 -32
WIRE -160 224 -272 224
WIRE -272 256 -272 224
WIRE -608 304 -608 272
WIRE -160 320 -160 224
WIRE 240 320 240 -112
WIRE 1360 320 1360 272
WIRE -512 368 -608 368
WIRE -272 368 -272 336
WIRE -272 368 -512 368
WIRE -176 368 -272 368
WIRE 160 368 -80 368
WIRE 288 368 288 160
WIRE 288 368 256 368
WIRE 432 368 288 368
WIRE 736 368 432 368
WIRE 1264 368 816 368
WIRE 1360 368 1264 368
WIRE -608 400 -608 368
WIRE 288 400 288 368
WIRE 1360 400 1360 368
WIRE 432 416 432 368
WIRE -608 512 -608 480
WIRE 288 512 288 480
WIRE 432 512 432 480
WIRE 1360 512 1360 480
FLAG -608 144 0
FLAG -608 512 0
FLAG 1360 320 0
FLAG 288 512 0
FLAG 1360 32 0
FLAG -608 304 0
FLAG -512 176 RX_PC
FLAG -512 368 TX_PC
FLAG 1264 368 RX_DUT
FLAG 1264 176 TX_DUT
FLAG 1360 512 0
FLAG 432 512 0
FLAG 752 32 0
FLAG -752 144 0
SYMBOL res -112 48 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL nmos -80 320 R90
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL nmos 384 128 M90
SYMATTR InstName M2
SYMATTR Value 2N7002
SYMBOL schottky 1168 -96 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 272 64 R0
SYMATTR InstName R2
SYMATTR Value 1k
SYMBOL voltage -608 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 3.3
SYMBOL res 272 384 R0
SYMATTR InstName R4
SYMATTR Value 2k
SYMBOL res 512 0 R0
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL sw 240 -112 R90
SYMATTR InstName S1
SYMATTR Value mysw
SYMBOL res 1344 -112 R0
SYMATTR InstName R_Vin_DUT
SYMATTR Value 100k
SYMBOL res -624 176 R0
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL res 1344 384 R0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL voltage 128 -240 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 1
SYMBOL cap -32 80 R0
SYMATTR InstName C1
SYMATTR Value 220p
SYMBOL voltage -608 384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=100
SYMATTR InstName V2
SYMATTR Value PULSE(0 3.3 10u 1n 1n 10u 20u)
SYMBOL cap 416 416 R0
SYMATTR InstName C2
SYMATTR Value 470p
SYMBOL res 832 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 100
SYMBOL nmos 160 128 R90
SYMATTR InstName M3
SYMATTR Value 2N7002
SYMBOL nmos 160 320 M90
SYMATTR InstName M4
SYMATTR Value 2N7002
SYMBOL cap 736 -80 R0
SYMATTR InstName C3
SYMATTR Value 10µ
SYMBOL res 832 160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 22
SYMBOL voltage 1360 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=100
SYMATTR InstName V3
SYMATTR Value PULSE(0 3.3 10u 1n 1n 10u 20u)
SYMBOL voltage -752 16 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 5
SYMBOL res 1024 -128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_Isense
SYMATTR Value 0.01
SYMBOL res -288 240 R0
SYMATTR InstName R3
SYMATTR Value 100k
TEXT 352 -208 Left 2 !.model mysw sw(Ron=0.01 Roff=1G Vt=0.5 Vh=0.4)
TEXT 360 -232 Left 2 !.tran 1m
TEXT -600 -384 Left 2 ;M3 & M1 : protect programmer from high voltages on DUT.\nR6 : protect M1 when TX_PC is low, while high voltage is injected on RX_DUT\nR4 & R5 : discharge lines when power is off.\nR2 & R4 : voltage divider 5V to 3V3 on RX_IN
TEXT -536 608 Left 2 ;M2 & M4 : prevent leakage into DUT when it's not powered : parasitic powering.  \nIt would be better to incorporate this onto the DUT.\nR2 and R5 are required as pull-ups.  They should pull up to the DUT's internal VCC, which is unavailable.\nThis can be circumvented by replacing M2&M4 by schottkey diodes.  The drawback is that the forward voltage is higher.
