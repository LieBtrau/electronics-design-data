Version 4
SHEET 1 2320 764
WIRE 800 256 0 256
WIRE 912 256 800 256
WIRE 1248 256 1168 256
WIRE 2064 256 1248 256
WIRE 800 288 800 256
WIRE 1248 288 1248 256
WIRE 912 368 912 256
WIRE 1168 368 1168 256
WIRE 800 416 800 368
WIRE 800 416 144 416
WIRE 896 416 800 416
WIRE 1088 416 992 416
WIRE 1248 416 1248 368
WIRE 1248 416 1184 416
WIRE 800 448 800 416
WIRE 0 464 0 256
WIRE 144 464 144 416
WIRE 1248 464 1248 416
WIRE 1392 464 1392 416
WIRE 2064 480 2064 256
WIRE 0 592 0 544
WIRE 144 592 144 544
WIRE 800 592 800 528
WIRE 1248 608 1248 544
WIRE 1392 608 1392 544
WIRE 2064 608 2064 560
FLAG 0 592 0
FLAG 144 592 0
FLAG 1248 608 0
FLAG 2064 608 0
FLAG 1392 608 0
FLAG 800 592 0
SYMBOL nmos 992 368 R90
SYMATTR InstName M1
SYMATTR Value BSS138P
SYMATTR Prefix X
SYMBOL voltage 144 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=100
SYMATTR InstName V1
SYMATTR Value PULSE(0 1.8 0 1n 1n {1/baudrate} {2/baudrate})
SYMBOL voltage 0 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 1.8
SYMBOL res 1232 448 R0
SYMATTR InstName R3
SYMATTR Value 1Meg
SYMBOL res 784 272 R0
SYMATTR InstName R1
SYMATTR Value 1k
SYMBOL nmos 1088 368 M90
SYMATTR InstName M2
SYMATTR Value BSS138P
SYMATTR Prefix X
SYMBOL res 1264 272 M0
SYMATTR InstName R4
SYMATTR Value 1k
SYMBOL voltage 2064 464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 3.3
SYMBOL voltage 1392 448 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=100
SYMATTR InstName V4
SYMATTR Value PULSE(0 3.3 0 1n 1n {1/baudrate} {2/baudrate})
SYMBOL res 784 432 R0
SYMATTR InstName R2
SYMATTR Value 1Meg
TEXT 576 144 Left 2 !.inc BSS138P_2011.txt\n.tran 50u\n.param baudrate=400k
TEXT 616 664 Left 2 ;I²C (or other open-drain bus) level shifting\nV2 can be higher or lower than V3\nWhen V3=0V (e.g. sensor turned off), then there's no leakage from V2 powered circuitry into V3.\nThe 1Mohm resistors are simulating the input impedance of an MCU-pin or sensor-pin.
