Version 4
SHEET 1 1844 680
WIRE 560 -384 -656 -384
WIRE -656 -224 -656 -384
WIRE -528 -224 -656 -224
WIRE -368 -224 -432 -224
WIRE -256 -224 -368 -224
WIRE -160 -224 -256 -224
WIRE -48 -224 -160 -224
WIRE 192 -224 -48 -224
WIRE -48 -192 -48 -224
WIRE -368 -176 -368 -224
WIRE -256 -176 -256 -224
WIRE -160 -176 -160 -224
WIRE -448 -80 -448 -176
WIRE -368 -80 -368 -96
WIRE -368 -80 -448 -80
WIRE -448 -64 -448 -80
WIRE -256 -32 -256 -96
WIRE -256 -32 -416 -32
WIRE -256 -16 -256 -32
WIRE 560 -16 560 -384
WIRE 336 48 336 -64
WIRE -448 96 -448 0
WIRE -256 96 -256 64
WIRE -160 96 -160 -112
WIRE 560 128 560 64
WIRE 192 176 192 -224
WIRE -48 192 -48 -112
WIRE 160 192 -48 192
WIRE 336 208 336 128
WIRE 336 208 224 208
WIRE 512 208 336 208
WIRE -656 224 -656 -224
WIRE -592 224 -656 224
WIRE -512 224 -592 224
WIRE -288 224 -432 224
WIRE 160 224 -288 224
WIRE -48 256 -48 192
WIRE -800 272 -800 192
WIRE -656 272 -656 224
WIRE 192 288 192 240
WIRE -288 304 -288 224
WIRE -48 352 -48 336
WIRE 208 352 -48 352
WIRE -48 368 -48 352
WIRE 336 432 336 208
WIRE 336 432 256 432
WIRE 336 448 336 432
WIRE -800 560 -800 352
WIRE -656 560 -656 352
WIRE -288 560 -288 384
WIRE -288 560 -656 560
WIRE -48 560 -48 448
WIRE -48 560 -288 560
WIRE 208 560 208 448
WIRE 208 560 -48 560
WIRE 336 560 336 512
WIRE 336 560 208 560
WIRE 560 560 560 224
WIRE 560 560 336 560
WIRE -656 576 -656 560
FLAG 192 288 0
FLAG -656 576 0
FLAG -448 96 0
FLAG -256 96 0
FLAG -160 96 0
FLAG -592 224 MOTOR
FLAG 336 -64 5V
FLAG -800 192 5V
FLAG -800 560 0
DATAFLAG 64 192 ""
DATAFLAG 144 -224 ""
SYMBOL Parts_TCO\\TS391 192 144 R0
SYMATTR InstName U1
SYMBOL voltage -656 256 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PWL(0 40 1m 60 2m 40)
SYMBOL res -64 -208 R0
SYMATTR InstName R1
SYMATTR Value 2k
SYMBOL res -64 240 R0
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res -64 352 R0
SYMATTR InstName R3
SYMATTR Value 330
SYMBOL nmos 256 352 M0
SYMATTR InstName M1
SYMATTR Value 2N7002
SYMBOL res 320 32 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res -416 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 270k
SYMBOL res -272 400 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 91k
SYMBOL nmos 512 128 R0
SYMATTR InstName M2
SYMATTR Value SP8K31
SYMBOL res 544 -32 R0
SYMATTR InstName Rheater
SYMATTR Value 10
SYMBOL cap 320 448 R0
SYMATTR InstName C1
SYMATTR Value 220p
SYMBOL Parts_TCO\\TLV431 -448 -32 R0
SYMATTR InstName U2
SYMBOL Parts_TCO\\BSS169 -528 -176 R270
SYMATTR InstName U3
SYMBOL res -384 -192 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res -272 -192 R0
SYMATTR InstName R8
SYMATTR Value 91k
SYMBOL res -272 -32 R0
SYMATTR InstName R9
SYMATTR Value 8.2k
SYMBOL cap -176 -176 R0
SYMATTR InstName C2
SYMATTR Value 100n
SYMBOL voltage -800 256 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 5
TEXT -688 600 Left 2 !.tran 2m
TEXT 760 -280 Left 2 ;Circuit around U3 is a disrete 15V LDO.  It has a decent PSRR, which prevents the \nin- threshold to shift when the motor voltage rises.\nBy supplying the comparator with 15V instead of 5V, a much higher input common mode\nrange is possible.  This avoids having to divide the motor voltage too far down and allows for\na tighter threshold control on the motor voltage.\n \nThe gate voltage of the NMOS is controlled by a separate 5V'ish supply to avoid exceeding \nthe maximum gate voltage.  5V is present in the rest of the circuit anyway.\n \nBy configuring M1 as shown, a non-inverting comparator is built.  This has the advantage\nthat a ground referenced NMOS can be used instead of a PMOS floating at the motor voltage.
